**Dockerfile** – это конфигурационный файл, который описывает инструкции, применяемые при сборке Docker-образа и в последующем запуске контейнера. Такой файл создается в корневой директории проекта. 

***bad practices***
1. ***Не указывать нужную версию базового образа, а использовать тег latest*** - не очень хорошая практика, так как обновление образа может привести к несовместимости кода и все сломается.
   Исправление: указываем стабильную версию образа
   ```
   <code>FROM python:3.9-slim</code>
   ```

3. ***Установка большого количества пакетов в одном слое***. Это затрудняет процесс кэширования и увеличивает размер образа. Также это плохо в случае, если одна из команд не сработает - тогда другие не сработают тоже, и все предыдущие изменения просто потеряются( 
Однако слишком много слоев - тоже не очень хорошая практика, лучше объединять одинаковые или однородные команды, тем самым сделав наш образ чуть меньше и лаконичнее, а слои, которые могут кэшироваться - писать раздельно. В дополнение к этому, при установке пакетов стоит **очищать кэш в той же команде**, чтобы ненужные файлы не попали в следующий слой и не замедляли загрузку образа и его развертывание.

   ```
   #Устанавливаем зависимости в одном слое, не очищаем кэш
   RUN apt-get update && apt-get install -y \
   python3 \
   python3-pip \
   curl \
   git \
   vim
   ```
   
  Исправление: Разделяем команды на слои 
  
   ```
   # Обновляем список пакетов
   RUN apt-get update && \
       apt-get install -y --no-install-recommends python3 python3-pip && \
       apt-get clean && rm -rf /var/lib/apt/lists/*
        
   # Устанавливаем curl
   RUN apt-get update && \
       apt-get install -y --no-install-recommends curl && \
       apt-get clean && rm -rf /var/lib/apt/lists/*
        
   # Устанавливаем git и vim
   RUN apt-get update && \
       apt-get install -y --no-install-recommends git vim && \
       apt-get clean && rm -rf /var/lib/apt/lists/*
   ```

5. ***Запуск от имени root***. Эти очень небезопасно – любой человек сможет получить полный контроль над контейнером. Лучше создать отдельного пользователя с ограниченными правами для повышения безопасности нашего контейнера.
   ```
   USER root
   ```
     Исправление: Создаем нового пользователя и прописываем его в конфигурации
   ```
   RUN useradd -m appuser
   USER appuser
   ```

6. ***Копирование всех файлов без исключения***. Приводит как к уязвимости контейнера, так и к неоправданному увеличению размера файловой системы нашего контейнера. Лучше скопировать в контейнер только то, без чего он не сможет нормально работать.
   ```
   COPY . /app
   ```
     Исправление: Копируем только необходимые файлы
   ```
   COPY requirements.txt /app/
   COPY app.py /app/
   ```

7. ***Установка зависимости приложения без указания конкретной версии***. Может оказаться так, что докер выберет версию пакета, которая отличается от нужной. Это может вызвать неожиданное поведение приложения.
   ```
   RUN pip3 install -r requirements.txt
   ```
     Исправление: Устанавливаем зависимости с указанием версий
   ```
   RUN pip3 install --no-cache-dir -r requirements.txt
   ```

***Плохие практики по работе с контейнерами***
1. Не использовать .dockerignore. В нем перечисляются все файлы и папки, которые будут игнорироваться при создании образа Docker: такие автоматически сгенерированные папки, как target и build, файлик readme и так далее. Это практика позволит уменьшить размер нашего образа и сберечь ресурсы.
2. Не сканировать наш Docker образ на наличие уязвимостей в системе безопасности. Для этого существует команда docker scan, которая выведет тип уязвимости, а также библиотеку, которая эту уязвимость исправляет. Тогда можно будет просто обновить свои библиотеки и избавиться от проблем! Также сканирование можно автоматизировать, настроив Docker Hub, который будет сканировать образ каждый раз, когда он пушится в репозиторий.
3. Запускать контейнер от пользователя с высокими привилегиями, так как при взломе может быть плохо. Лучше создать нового пользователя (как это было сделано в исправленном DockerFile) и задать ему ограниченные права и необходимые привилегии, необходимые для конкретного контейнера. 
